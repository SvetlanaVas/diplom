# Дипломный проект профессия Тестировщик

### Автоматизация тестирования комплексного сервиса, взаимодействующего с СУБД и API Банка
**Основная задача:** Тестирование покупки тура двумя способами:
* Обычная оплата по дебетовой карте
* Уникальная технология: выдача кредита по данным банковской карты

**Действия, необходимые для запуска Приложения** и его тестирования:

**1.** Запуск Docker

**2.** В терминале IDEA загрузить контейнеры mysql, postgres и образ платежного шлюза nodejs в терминале IDEA командой  
   docker-compose up
   
**3.** Во втором терминале из директории artifacts запустить SUT командой:
 * для конфигурации с базой MySql 
 
java -jar aqa-shop.jar
 * для конфигурации с базой PostgreSql
 
 java -Dspring.datasource.url=jdbc:postgresql://localhost:5432/app -jar aqa-shop.jar
 
**4.** В браузере SUT открывается: localhost:8080

**5.** Запуск автотестов командой:
* для конфигурации с MySql
gradlew test 
* для конфигурации с PostgreSql
gradlew test -Dspring.datasource.url=jdbc:postgresql://localhost:5432/app


### 1. Перечень автоматизируемых сценариев
**Под Валидными данными понимаем:**

**Месяц** - +2 за текущим

**Год** - от 20 до 22 включительно  

**CVC** - от 100 до 999 включительно

**Владелец** - Имя Фамилия на латинице

**Номер карты** - 4444 4444 4444 4441 или 4444 4444 4444 4442

## Позитивные сценарии:
**1.** Отправить заявку с валидными данными в случае приобретения тура с оплатой дебитовой APPROVED картой:
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными и кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется всплывающее сообщение "Операция одобрена банком". В поле transaction_id таблицы payment_entity и в поле payment_id таблицы order_entity должны появиться записи.
 
 **Фактический результат**: после нажатия кнопки "Продолжить" текст на ней поменялся на "Отправляем запрос в банк". По окончании появляется сообщение: "Успешно.  Операция одобрена банком". В поле transaction_id таблицы payment_entity и в поле payment_id таблицы order_entity появляются записи.

**2.** Отправить заявку с валидными данными в случае приобретения тура с оплатой дебитовой DECLINED картой:
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными и кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется  сообщение "Ошибка! Банк отказал в проведении операции"
 
 **Фактический результат:** после нажатия кнопки "Продолжить" текст на ней поменялся на "Отправляем запрос в банк". По окончании появляется сообщение: "Успешно. Операция одобрена банком" Тест упал.

**3.** Отправить заявку с валидными данными в случае приобретения тура в кредит по APPROVED карте:
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть  кнопку "Купить в кредит"
* Заполнить поля валидными данными и кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется  сообщение "Операция одобрена". В поле bank_id таблицы credit_request_entity и в поле payment_id таблицы order_entity должны появиться записи.
 
 **Фактический результат:** после нажатия кнопки "Продолжить" текст на ней поменялся на "Отправляем запрос в банк". По окончании появляется сообщение: "Успешно. Операция одобрена банком".В поле bank_id таблицы credit_request_entity и в поле payment_id таблицы order_entity  появляются записи.

**4.** Отправить заявку с валидными данными в случае приобретения тура в  кредит по DECLINED карте:
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть  кнопку "Купить в кредит"
* Заполнить поля валидными данными и кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется  сообщение "Ошибка! Банк отказал в проведении операции"
 
 **Фактический результат:** после нажатия кнопки "Продолжить" текст на ней поменялся на "Отправляем запрос в банк". По окончании появляется сообщение: "Успешно. Операция одобрена банком" Тест упал.
 Если смоделировать ситуацию успешного прохождения теста (тест shouldGetResponseDeclinedIfDeclinedCreditCard), то в поле status таблицы credit_request_entity появится Declined.

**5.** Отправить заявку с дебетовой картой со статусом Approved. Проверить ответ от эмулятора банковской системы.
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть  кнопку "Купить"
* Заполнить поля валидными данными. Номер карты 4444 4444 4444 4441. Кликнуть кнопку "Продолжить"

**Ожидаемый результат:** в поле status таблицы payment_entity появляется сообщение Approved.

**Фактический результат:** в поле status таблицы payment_entity появляется сообщение Approved.

**6.** Отправить заявку с кредитной картой со статусом Approved. Проверить ответ от эмулятора банковской системы.
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть  кнопку "Купить в кредит"
* Заполнить поля валидными данными. Номер карты 4444 4444 4444 4441. Кликнуть кнопку "Продолжить"

**Ожидаемый результат:** в поле status таблицы credit_request_entity появляется сообщение Approved.

**Фактический результат:** в поле status таблицы credit_request__entity появляется сообщение Approved.

**7.** Отправить заявку с дебетовой картой со статусом Declined. Проверить ответ от эмулятора банковской системы.
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть  кнопку "Купить"
* Модифицируем тест №2, чтобы он не падал (соглашаемся, что при ввода номера карты со статусом Declined может появиться сообщение "Успешно")
* Заполнить поля валидными данными. Номер карты 4444 4444 4444 4442. Кликнуть кнопку "Продолжить"

**Ожидаемый результат:** в поле status таблицы payment_entity появляется сообщение Declined

**Фактический результат:** в поле status таблицы payment_entity появляется сообщение Declined

## Негативные сценарии:
**1.** Отправить заявку в случае приобретения тура с оплатой дебетовой картой. Все поля заполнены невалидными данными.
* Открыть  в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить все поля заведомо невалидными данными и кликнуть кнопку "Продолжить"

 **Ожидаемый результат:** под всеми полями появятся строки-предупреждения о неверно введенных данных
 
 **Фактический результат:** под всеми полями появились строки-предупреждения о неверно введенных данных

**2.** Отправить заявку в случае приобретения тура с оплатой кредитной картой. Все поля заполнены невалидными данными.
* Открыть  в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить в кредит"
* Заполнить все поля заведомо невалидными данными и кликнуть кнопку "Продолжить"

**Ожидаемый результат:** под всеми полями появятся строки-предупреждения о неверно введенных данных

**Фактический результат:** под всеми полями появились строки-предупреждения о неверно введенных данных

**3.** Отправить заявку в случае приобретения тура с оплатой дебетовой картой с именем и фамилией "Владельца" кириллицей.
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными, поле "Владелец" заполнить кириллицей, кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** под полем "Владелец"появляется сообщение "Неверный формат"
 
 **Фактический результат:** появилось сообщение "Успешно. Операция одобрена банком". Тест упал.

**4.** Отправить заявку с полем Месяц, в которое введено значение предыдущего месяца.
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данные, поле "Месяц" заполнить значение предыдущего месяца. Год - текущий. Кликнуть кнопку "Продолжить"

**Ожидаемый результат:** под полем "Месяц" появляется сообщение "Неверно указан срок действия карты"

**Фактический результат:** под полем "Месяц" появляется сообщение "Неверно указан срок действия карты"

**5.** Отправить заявку с пустым полем "Месяц"
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными, поле "Месяц" оставить пустым, кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** под полем "Месяц"появляется сообщение "Неверный формат"
 
 **Фактический результат:** под полем "Месяц" появляется сообщение "Неверный формат"

**6 .** Отправить заявку с пустым полем "Номер карты"
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными, поле "Номер карты" оставить пустым, кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** под полем "Номер карты" появляется сообщение "Неверный формат"
 
 **Фактический результат:**: под полем "Номер карты" появляется сообщение "Неверный формат"
 
 **7.** Отправить заявку со значением поля "Год" на 10 лет больше текущего
 * Открыть в браузере  http://localhost:8080/
 * На главной странице кликнуть кнопку "Купить"
 * Заполнить поля валидными данными, в поле "Год" ввести значение на 10 лет больше текущего года, кликнуть  кнопку "Продолжить"
 
 **Ожидаемый результат:** под полем "Год" появляется сообщение "Неверно указан срок действия карты"
 
  **Фактический результат:** под полем "Год" появляется сообщение "Неверно указан срок действия карты"
 
**8.** Отправить заявку с пустым полем "Год"
* Открыть в браузере  http://localhost:8080/
* На главной странице кликнуть кнопку "Купить в кредит"
* Заполнить поля валидными данными, поле "Год" оставить пустым, кликнуть  кнопку "Продолжить"

**Ожидаемый результат:** под полем "Год" появляется сообщение "Неверный формат"

**Фактический результат:** под полем "Год" появляется сообщение "Неверный формат"

**9.** Отправить заявку с пустым полем "Владелец"
* Открыть в браузере http://localhost:8080/
* На главной странице кликнуть кнопку "Купить"
* Заполнить поля валидными данными, поле "Владелец" оставить пустым, кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется сообщение "Поле обязательно для заполнения"
 
 **Фактический результат:** появляется сообщение "Поле обязательно для заполнения"

**10.** Отправить заявку с пустым полем "CVC/CVV"
* Открыть в браузере http://localhost:8080/
* На главной странице кликнуть кнопку "Купить в кредит"
* Заполнить поля валидными данными, поле "Владелец" оставить пустым, кликнуть  кнопку "Продолжить"

 **Ожидаемый результат:** появляется сообщение "Неверный формат"
 
 **Фактический результат:** появляется сообщение "Неверный формат"
 
 **11.** Отправить заявку с несуществующим номером карты
 * Открыть в браузере http://localhost:8080/
 * На главной странице кликнуть кнопку "Купить в кредит"
 * Заполнить поля валидными данными, в поле "Номер карты" ввести 5555555555555555, кликнуть  кнопку "Продолжить"
 
  **Ожидаемый результат:** появляется сообщение "Ошибка! Банк отказал в проведении операции"
  
  **Фактический результат:** появляется сообщение "Ошибка! Банк отказал в проведении операции"
                               




### 2. Перечень используемых инструментов с обоснованием выбора
1. Java 8 — язык написания авто-тестов. Удобен тем, что поддерживает большое количество библиотек для написания кода автотестов.
1. IntelliJ IDEA — интегрированная среда разработки программного обеспечения. Подходит для работы на Java, JavaScript, Python. Выбор обусловлен тем, что автотесты написаны на Java, а IDEA содержит Java Virtual Machine. Поддерживает операционные системы Microsoft Windows, Linux, macOC.
1. Gradle — система управления зависимостями. Проект с автотестами создан на базе Gradle.
1. JUnit — платформа для написания авто-тестов и их запуска. Легко подключается в файле build.gradle.
1. Git и GitHub — удобно использовать для хранения версий
1. Selenide —  фреймворк для автоматизированного тестирования веб- приложений на основе Selenium WebDriver. Удобен тем, что легко добавляется в зависимости в файл build.gradle. Не требует отдельной загрузки браузера.
1. Faker -  библиотека, которую можно использовать для генерации случайных данных
1. Lombok - добавляет Java дополнительную функциональность, позволяет  избавиться от многословности. "Возвращает Java былую славу"
1. Allure -позволяет создать  наглядную картину выполнения тестов

### 3. Перечень необходимых разрешений/данных/доступов от банка
1. Необходим "тестовый" режим SUT, на котором можно проверить демо-данные
1. Поддержка двух СУБД:
   * MySQL
   * Postgres
1. Симулятор банковских сервисов, который может принимать запросы в нужном формате и генерировать ответы

### 4. Перечень и описание возможных рисков при автоматизации
1. Сложность нахождения необходимых селекторов в имеющейся структуре сайта
1. Риск выявления в ходе тестирования необходимости реализации дополнительных сценариев
1. Высокая трудоёмкость с организацией нескольких вариантов тестовых стендов: Windows, Linux, с Doker и без него
1. Возможные проблемы с интеграцией системы с Appveyor CI

### 5. Перечень необходимых специалистов для автоматизации
1. QA Engineer

### 6. Интервальная оценка с учетом рисков (в часах): 50-75 час.

### 7. План сдачи работы
1. Планирование автоматизации тестирования до 26.02.2020г.
1. Написание и выполнение тестов до 05.03.2020г.
1. Подготовке отчётных документов по итогам автоматизированного тестирования до 10.03.2020г.
1. Подготовка отчётных документов по итогам автоматизации до 13.03.2020г.
